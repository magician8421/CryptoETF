# 经济模型

**一个代币 etf，其中 btc 占 20%，link 占 80%，初次 mint 了 200USDT，100 份。那么在赎回时，1 份 etf 可以换多少 btc 和 link，如何计算。如果赎回时每分 etf 涨价了，如何计算**

---

### 1. 初始分配

- **总价值**：200 USDT
- **份额**：100 份
- **每份初始价值**：2 USDT
- **BTC 占比**：20%（40 USDT）
  - 初始 BTC 价格：40,000 USDT
  - BTC 数量：`40 USDT / 40,000 USDT = 0.001 BTC`
  - 每份 BTC 数量：`0.001 BTC / 100 = 0.00001 BTC`
- **LINK 占比**：80%（160 USDT）
  - 初始 LINK 价格：20 USDT
  - LINK 数量：`160 USDT / 20 USDT = 8 LINK`
  - 每份 LINK 数量：`8 LINK / 100 = 0.08 LINK`

---

### 2. 赎回时的情况

假设赎回时：

- BTC 价格上涨到 45,000 USDT
- LINK 价格上涨到 25 USDT

由于 ETF 的涨价完全是由底层资产价格上涨引起的，**每份 ETF 对应的底层资产数量不变**：

- 每份 BTC 数量：`0.00001 BTC`
- 每份 LINK 数量：`0.08 LINK`

---

### 3. 计算赎回时的价值

- **每份 BTC 价值**：`0.00001 BTC * 45,000 USDT = 0.45 USDT`
- **每份 LINK 价值**：`0.08 LINK * 25 USDT = 2 USDT`
- **每份 ETF 总价值**：`0.45 USDT + 2 USDT = 2.45 USDT`

---

### 4. 总结

赎回时，每份 ETF 可以兑换：

- **BTC**：`0.00001 BTC`
- **LINK**：`0.08 LINK`

这些资产的总价值为  **2.45 USDT**，比初始的 2 USDT 上涨了，这是因为底层资产（BTC 和 LINK）的价格上涨了。

---

### 5. 关键点

- **ETF 涨价的原因**：如果 ETF 的涨价完全是由底层资产价格上涨引起的，那么每份 ETF 对应的底层资产数量不会改变。
- **赎回机制**：用户赎回时，获得的是固定数量的底层资产（BTC 和 LINK），其价值随底层资产价格波动。

---

### 6. 示例表格

| **资产** | **每份数量** | **初始价格** | **初始价值** | **赎回时价格** | **赎回时价值** |
| -------- | ------------ | ------------ | ------------ | -------------- | -------------- |
| BTC      | 0.00001 BTC  | 40,000 USDT  | 0.4 USDT     | 45,000 USDT    | 0.45 USDT      |
| LINK     | 0.08 LINK    | 20 USDT      | 1.6 USDT     | 25 USDT        | 2 USDT         |
| **总计** | -            | -            | **2 USDT**   | -              | **2.45 USDT**  |

---

### 7. 最终答案

赎回时，每份 ETF 可以兑换：

- **BTC**：`0.00001 BTC`
- **LINK**：`0.08 LINK`

这些资产的总价值为  **2.45 USDT**，反映了底层资产价格的上涨。

如果用户再追加 300USDT，考虑到现在每分 ETF 已经涨到了 2.45USDT，追加过程以及 mint 的份数应该怎么计算

**如果用户追加 300 USDT，考虑到每份 ETF 的当前价值已经涨到了  2.45 USDT，我们需要计算用户可以 Mint 的新份额数量，并更新底层资产（BTC 和 LINK）的分配。**

---

### 1. 当前状态

- **每份 ETF 价值**：2.45 USDT
- **追加资金**：300 USDT
- **当前总份额**：100 份
- **当前总价值**：100 份 \* 2.45 USDT = 245 USDT

---

### 2. 计算 Mint 的新份额数量

用户追加 300 USDT，按照当前每份 ETF 的价值（2.45 USDT），可以 Mint 的新份额数量为：

新份额数量=追加资金每份  ETF  价值=3002.45≈122.448  份

新份额数量=每份  ETF  价值追加资金=2.45300≈122.448  份

---

### 3. 更新总份额和总价值

- **新总份额**：100 份 + 122.448 份 ≈ 222.448 份
- **新总价值**：245 USDT + 300 USDT = 545 USDT

---

### 4. 计算追加资金对应的底层资产分配

追加的 300 USDT 需要按照当前底层资产的比例（BTC 占 20%，LINK 占 80%）分配到 BTC 和 LINK 中。

### 4.1 计算追加的 BTC 和 LINK 价值

- **追加 BTC 价值**：300 USDT \* 20% = 60 USDT
- **追加 LINK 价值**：300 USDT \* 80% = 240 USDT

### 4.2 计算追加的 BTC 和 LINK 数量

假设当前 BTC 价格为 45,000 USDT，LINK 价格为 25 USDT：

- **追加 BTC 数量**：60 USDT / 45,000 USDT ≈ 0.001333 BTC
- **追加 LINK 数量**：240 USDT / 25 USDT = 9.6 LINK

---

### 5. 更新底层资产总量

- **BTC 总量**：
  - 初始 BTC 数量：0.001 BTC
  - 追加 BTC 数量：0.001333 BTC
  - 新 BTC 总量：0.001 + 0.001333 ≈ 0.002333 BTC
- **LINK 总量**：
  - 初始 LINK 数量：8 LINK
  - 追加 LINK 数量：9.6 LINK
  - 新 LINK 总量：8 + 9.6 = 17.6 LINK

---

### 6. 更新每份 ETF 对应的底层资产数量

- **每份 BTC 数量**：
  - 新 BTC 总量：0.002333 BTC
  - 新总份额：222.448 份
  - 每份 BTC 数量：0.002333 BTC / 222.448 ≈ 0.00001049 BTC
- **每份 LINK 数量**：
  - 新 LINK 总量：17.6 LINK
  - 新总份额：222.448 份
  - 每份 LINK 数量：17.6 LINK / 222.448 ≈ 0.0791 LINK

---

### 7. 总结

- **Mint 的新份额**：122.448 份
- **新总份额**：222.448 份
- **新总价值**：545 USDT
- **每份 ETF 对应的底层资产**：
  - BTC：≈ 0.00001049 BTC
  - LINK：≈ 0.0791 LINK

---

### 8. 验证

- **每份 ETF 价值**：
  - BTC 价值：0.00001049 BTC \* 45,000 USDT ≈ 0.472 USDT
  - LINK 价值：0.0791 LINK \* 25 USDT ≈ 1.977 USDT
  - 每份 ETF 总价值：0.472 + 1.977 ≈ 2.45 USDT（与当前每份 ETF 价值一致）

---

### 9. 最终结果

- 用户追加 300 USDT，可以 Mint 约  **122.448 份**  新 ETF。
- 更新后，每份 ETF 对应的底层资产为：
  - **BTC**：≈ 0.00001049 BTC
  - **LINK**：≈ 0.0791 LINK

**每份 ETF 中的 BTC 和 LINK 的数量是否会与第一次 Mint 时相同，取决于追加 Mint 时的条件**。以下是两种常见情况的分析：

---

### 情况 1：追加 Mint 时，底层资产价格不变

如果追加 Mint 时，底层资产（BTC 和 LINK）的价格与第一次 Mint 时相同，那么每份 ETF 中的 BTC 和 LINK 的数量会**保持不变**。

### 示例：

- 第一次 Mint：
  - BTC 价格：40,000 USDT
  - LINK 价格：20 USDT
  - 每份 ETF 包含：
    - BTC：0.00001 BTC
    - LINK：0.08 LINK
- 追加 Mint：
  - BTC 价格仍为 40,000 USDT
  - LINK 价格仍为 20 USDT
  - 每份 ETF 仍包含：
    - BTC：0.00001 BTC
    - LINK：0.08 LINK

在这种情况下，**每份 ETF 中的 BTC 和 LINK 数量与第一次 Mint 时相同**。

---

### 情况 2：追加 Mint 时，底层资产价格上涨

如果追加 Mint 时，底层资产（BTC 和 LINK）的价格上涨，那么每份 ETF 中的 BTC 和 LINK 的数量会**减少**。

### 示例：

- 第一次 Mint：
  - BTC 价格：40,000 USDT
  - LINK 价格：20 USDT
  - 每份 ETF 包含：
    - BTC：0.00001 BTC
    - LINK：0.08 LINK
- 追加 Mint：
  - BTC 价格上涨到 45,000 USDT
  - LINK 价格上涨到 25 USDT
  - 每份 ETF 包含：
    - BTC：≈ 0.00001049 BTC（比第一次 Mint 时减少）
    - LINK：≈ 0.0791 LINK（比第一次 Mint 时减少）

在这种情况下，**每份 ETF 中的 BTC 和 LINK 数量会比第一次 Mint 时少**，因为底层资产的价格上涨了，同样的资金能购买的资产数量减少了。

---

### 关键点总结

1. **如果底层资产价格不变**：
   - 每份 ETF 中的 BTC 和 LINK 数量与第一次 Mint 时相同。
2. **如果底层资产价格上涨**：
   - 每份 ETF 中的 BTC 和 LINK 数量会比第一次 Mint 时少。
3. **如果底层资产价格下跌**：
   - 每份 ETF 中的 BTC 和 LINK 数量会比第一次 Mint 时多。

---

### 为什么会出现这种情况？

- **ETF 的每份价值**是由底层资产的价格决定的。
- 当底层资产价格上涨时，同样的资金能购买的资产数量减少，因此每份 ETF 中的资产数量也会减少。
- 反之，当底层资产价格下跌时，同样的资金能购买的资产数量增加，因此每份 ETF 中的资产数量也会增加。

---

### 结论

**每份 ETF 中的 BTC 和 LINK 的数量是否与第一次 Mint 时相同，取决于追加 Mint 时的底层资产价格**：

- 如果价格不变，数量不变。
- 如果价格上涨，数量减少。
- 如果价格下跌，数量增加。

在设计代币 ETF 时，需要明确底层资产价格变化对每份 ETF 资产数量的影响，并在智能合约中实现相应的逻辑。
